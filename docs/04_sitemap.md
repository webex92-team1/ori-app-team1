# 🍳 FoodMatch サイトマップ（ページ構成・遷移・認可要件）

MVP 要件 × 初心者チーム向け × Next.js で実装しやすい構造でまとめています。

---

# 🌐 公開ページ（ログイン不要）

| パス     | ページ名       | 概要                                      |
| :------- | :------------- | :---------------------------------------- |
| `/`      | トップページ   | アプリ説明、Google ログインボタンへの導線 |
| `/login` | ログインページ | Google ログイン実行（Firebase Auth）      |

---

# 🔐 認証後ページ（ログイン必須）

ログインしていない場合は **すべて `/login` にリダイレクト**。

| パス           | ページ名         | 概要                                                |
| :------------- | :--------------- | :-------------------------------------------------- |
| `/ingredients` | 食材入力ページ   | 「卵 牛乳 玉ねぎ」などをテキストで入力              |
| `/recipes`     | レシピ一覧ページ | Rakuten レシピ API 結果を表示（足りない食材は灰色） |
| `/recipe/[id]` | レシピ詳細ページ | 材料・手順・お気に入りボタン・「作った！」ボタン    |
| `/mypage`      | マイページ       | お気に入り一覧・履歴一覧を表示                      |

---

# 🗺 ページ遷移フロー（初心者でもわかりやすい）

```mermaid
flowchart TD

A[トップページ /] -->|ログインボタン| B(/login)
B -->|Googleログイン成功| C(/ingredients)

C -->|検索| D(/recipes)
D -->|レシピを選択| E(/recipe/[id])

E -->|お気に入り| E
E -->|作った！| E

C -->|マイページへ| F(/mypage)
D -->|マイページへ| F
E -->|マイページへ| F
```

---

# 🔑 認可要件（アクセス制御）

初心者チームでも理解・実装しやすいルールにしています。

---

## ■ 公開ページ（誰でもアクセス可能）

| パス     | 認可      | 理由         |
| :------- | :-------- | :----------- |
| `/`      | 誰でも OK | LP の役割    |
| `/login` | 誰でも OK | ログイン処理 |

---

## ■ ログイン必須ページ

| パス           | 認可         | 理由                               |
| :------------- | :----------- | :--------------------------------- |
| `/ingredients` | ログイン必須 | ユーザー固有の操作前提             |
| `/recipes`     | ログイン必須 | 個別ユーザーごとに検索を扱う       |
| `/recipe/[id]` | ログイン必須 | お気に入りなどユーザー情報に紐づく |
| `/mypage`      | ログイン必須 | Firestore の個人データを表示       |

---

## ■ エラーページ

| パス | 認可 | 概要 |
| `/404` | 誰でも OK | ページが存在しない場合 |

---

# 🔒 Firestore の認可ルール（初心者向け）

```js
match /users/{uid} {
  allow read, write: if request.auth != null && request.auth.uid == uid;
}
```

- ログイン必須
- 自分のデータだけ読み書きできる
- 他ユーザーのデータは見れない

---

# 📌 ページごとの役割（解説）

### `/ingredients`

- MVP のメイン操作
- テキストボックスに「卵 牛乳 玉ねぎ」など入力
- ボタンを押すと `/recipes` に遷移

### `/recipes`

- Rakuten レシピ API の結果を一覧表示
- 足りない食材は灰色で表示する
- カードを押すと `/recipe/[id]`

### `/recipe/[id]`

- レシピ詳細
- ボタン 1 つで

  - お気に入り登録
  - 履歴に「作った！」を記録

### `/mypage`

- Firestore のデータ表示

  - favorites 配列
  - histories 配列
